<html>
<head>
<script>
function gen(){
var width = document.getElementById("width").value;
var height = document.getElementById("height").value;
var textarea = document.getElementById("area-output");

var bitmap = document.getElementById("bitmap"); //table


var out_string = "";
var byte_width = Math.trunc((width-1)/8+1);

for(row=0; row<height; row++){
  for(col=0; col<byte_width; col++){
     val = 0;
	 for(i=0;i<8;i++){
     var cell = bitmap.rows[row].cells[col*8+i];
	   mask = 0x01 << i;//0x80 >> i;
	   if(cell.className=="black") val |= mask;
	 }
	 out_string += "0x"+(val<16?"0":"")+val.toString(16).toUpperCase()+",";
  }
}

textarea.value = out_string;

//end gen()
}

function draw(){
var width = document.getElementById("width").value;
var height = document.getElementById("height").value;
var textarea = document.getElementById("area-input").value;

var canvas = document.getElementById("canvas");

var array = textarea.split(",");
var out_string = "";

var byte_width = Math.trunc((width-1)/8+1);
out_string+="<table id=\"bitmap\">";
for(row=0; row<height; row++){
  out_string+="<tr>";
  for(col=0; col<byte_width; col++){
     var ch = parseInt(array[col+row*byte_width]);
	 for(i=0;i<8;i++){
       out_string+="<td ";
	   mask = 0x01 << i;//0x80 >> i;
	   if((col*byte_width) > (col*8+i)) out_string+= "class=\"gray\">"  //&#9676"; //out of byte alignment
	   else 
		 if((ch&mask) == mask) out_string+= "class=\"black\" onmousedown=\"toggle(this);\">" //&#9679"; //black
		 else out_string+="class=\"white\" onmousedown=\"toggle(this);\">" //&#9675"; //white
       out_string+="</td>";
	 }
  }
  out_string+="</tr>";
  //out_string+="\n";
}
out_string+="</table>";

canvas.innerHTML = out_string;

//end draw()
}

function toggle(cell){
  if(cell.className == "black") cell.className="white";
  else if(cell.className == "white") cell.className="black";
//end gen()
}

</script>
<style>
#canvas{
	display: block;
}

#canvas tr{
	height: 8px;
}
#canvas td{
	width: 6px;
}

#canvas table, #canvas th, #canvas td {
    border: 1px dotted gray;
    border-collapse: collapse;
}

#canvas td:hover {
	opacity:0.4;
    border: 1px solid black;
}

.black{ background-color: black;}
.white{ background-color: white;}
.gray{ background-color: gray;}

</style>
</head>
<body>
<table>
<tr>
<td>
<textarea rows="1" cols="10" id="width">40</textarea>
<textarea rows="1" cols="10" id="height">42</textarea><br/>
<textarea rows="20" cols="50" id="area-input">0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x1F,0x00,0x00,0x00,0xF0,0x7F,0x00,0x00,0x00,0xF8,0xFF,0x01,0x00,0x00,0xFF,0xFF,0x07,0x00,0xC0,0xFF,0xFF,0x1F,0x00,0xE0,0xFF,0xFF,0x3F,0x00,0xF0,0xFF,0xFF,0x7F,0xF8,0xF3,0xFF,0xFF,0x7F,0xF8,0xFB,0xFF,0xFF,0xFF,0xF8,0xFB,0xFF,0xFF,0xFF,0x00,0xF8,0xFF,0xFF,0xFF,0x00,0xF8,0xFF,0xFF,0xFF,0x7F,0xF8,0xFF,0xFF,0xFF,0x7F,0xF0,0xFF,0xFF,0x7F,0x7F,0xF0,0xFF,0xFF,0x7F,0x00,0xE0,0xFF,0xFF,0x3F,0x00,0xC0,0xFF,0xFF,0x1F,0xFE,0x0F,0xFF,0xFF,0x0F,0xFF,0x1F,0xE0,0x7F,0x00,0xFE,0x0F,0x80,0x1F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x38,0x00,0x00,0x00,0x00,0x38,0x00,0x00,0x00,0x00,0x7C,0x00,0x00,0x00,0x00,0x7C,0x40,0x00,0x00,0x00,0x7C,0x40,0x00,0x00,0x00,0x38,0xE0,0x00,0x00,0x00,0x00,0xF0,0x01,0x00,0x00,0x00,0xF0,0x01,0x00,0x00,0x00,0xF0,0x01,0x00,0x00,0x00,0xE0,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00</textarea>
</td>
<td><button id="button-draw" onclick="draw();">draw &#8594;</button></td>
<td><div id="canvas"></div></td>
<td><button id="button-gen" onclick="gen();">gen &#8594;</button></td>
<td><textarea rows="20" cols="50" id="area-output"></textarea></td>
</tr>
</table>
<script>draw();</script>
</body>
</html>